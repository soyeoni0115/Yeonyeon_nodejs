# Node.js 4장

## 요청과 응담
- 서버는 클라이언트가 있기에 동작함
- 클라이언트에서 서버로 요청을 보내고, 서버에서는 요청의 내용을 읽고 처리한 뒤 클라이언트에 응답 전송
- 서버에 요청 받고 응답 보내는 부분 존재해야함
- http 서버가 있어야 요청 처리 가능
    - createServer 메서드 (createServer(req,res))
        - 인수로 요청에 대한 콜백 함수를 넣을 수 있고, 요청이 들어올 때마다 매번 콜백 함수 실행
        - req -> 요청, res -> 응답
- 한 번에 여러 서버 실행 가능
    - 이때 포트 번호는 달라야함

## Rest와 라우팅
- Rest: 서버의 자원을 정의하고 자원에 대한 주소를 지정하는 방법을 가리킴
    - 꼭 자원이 파일일 필요는 없고 서버가 행할 수 있는 것들을 통틀어 의미
    - 요청 메서드: GET, POST, PUT, DELETE, OPTIONS
    

## 쿠키와 세션
- 클라이언트에서 보내는 요청은 누가 보냈는지 모름
- 요청을 보내는 IP주소나 브라우저의 정보를 받아올 수 있음 but 여러 컴터가 공통으로 IP주소 갖을 수 있음
- => 로그인 기능 필요
- 서버는 요청에 대한 응답을 할 때 사용자가 누구인지 기억하기 위해 쿠키를 같이 보냄
    - 쿠키는 유효기간이 있으며 키-값의 쌍
    - 쿠키가 오면 웹 브라우저는 저장해뒀다가 다음에 요청할 때 다시 주고 받기를 반복
    - 쿠키는 요청의 헤더에 담겨 전송. 브라우저는 응답의 헤더에 따라 쿠키를 저장

## http와 http2
- http 모듈은 웹 서버에 SSL 암호화를 추가함
- GET이나 POST 요청을 할 떄 오가는 데이터를 암호화해서 중간에 다른 사람이 요청을 가로채더라도 내용 확인 불가하게 함
- http2 모듈은 SSL 암호화와 더불어 최신 HTTP 프로토콜인 http/2를 사용할 수 있게 함
- http/2는 요청 및 응답방식이 1.1보다 개선되어 훨씬 효율적으로 요청 보냄. 웹 속도도 ㅁ낳이 개선

## cluster
- 기본적으로 싱글 프로세스로 동작하는 노드가 CPU코어를 모두 사용할 수 있게 해줌
- 포트를 공유하는 노드 프로세스를 여러 개 둘 수도 있어, 요청이 많이 들어왔을 때 병렬로 실행된 서버의 개수만큼 요청이 분산되게 할 수 있음
- cluster 사용해 설정하면 코어 하나당 노드 프로세스 하나가 돌아가게 할 수 있음. 성능이 8배 개선되는 건 아니지만 코어 하나만 사용할 때에 비해 성능 개선
- but 메모리를 공유를 못함. 그래서 레디스 등의 서버를 도입해 그에 대한 문제를 해결할 수 있음